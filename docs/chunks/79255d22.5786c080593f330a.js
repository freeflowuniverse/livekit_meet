"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[348],{8728:function(e,t,n){let i,r,a,s,o,c;var l,u,d,h,f,p,y,m,g,b,v,k,w,S,T,I,E,N,C,A,L,O,U,F,D,R,P,x,_,B,M,K,V,j,G,J,q,X,W,H,Y,z,Q,$,Z,ee=n(257);function et(e,t,n,i){return new(n||(n=Promise))(function(r,a){function s(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,o)}c((i=i.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;var en="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ei={exports:{}};l=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],r={},a=null;function s(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(){for(var n=this.getLevel(),r=0;r<i.length;r++){var a=i[r];this[a]=r<n?e:this.methodFactory(a,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function l(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function u(i,r,a){var c;return"debug"===(c=i)&&(c="log"),typeof console!==t&&("trace"===c&&n?o:void 0!==console[c]?s(console,c):void 0!==console.log?s(console,"log"):e)||l.apply(this,arguments)}function d(e,n){var s,o,l,d=this,h="loglevel";function f(){var e;if(typeof window!==t&&h){try{e=window.localStorage[h]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,i=encodeURIComponent(h),r=n.indexOf(i+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r+i.length+1))[1])}catch(e){}return void 0===d.levels[e]&&(e=void 0),e}}function p(e){var t=e;if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?h+=":"+e:"symbol"==typeof e&&(h=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||u,d.getLevel=function(){return null!=l?l:null!=o?o:s},d.setLevel=function(e,n){return l=p(e),!1!==n&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&h){try{window.localStorage[h]=n;return}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"="+n+";"}catch(e){}}}(l),c.call(d)},d.setDefaultLevel=function(e){o=p(e),f()||d.setLevel(e,!1)},d.resetLevel=function(){l=null,function(){if(typeof window!==t&&h){try{window.localStorage.removeItem(h)}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),c.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(a!==d&&(s=p(a.getLevel())),c.call(d),a===d)for(var e in r)r[e].rebuild()},s=p(a?a.getLevel():"WARN");var y=f();null!=y&&(l=p(y)),c.call(d)}(a=new d).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw TypeError("You must supply a name when creating a logger.");var t=r[e];return t||(t=r[e]=new d(e,a.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return a.noConflict=function(){return typeof window!==t&&window.log===a&&(window.log=h),a},a.getLoggers=function(){return r},a.default=a,a},ei.exports?ei.exports=l():en.log=l();var er=ei.exports;(u=R||(R={}))[u.trace=0]="trace",u[u.debug=1]="debug",u[u.info=2]="info",u[u.warn=3]="warn",u[u.error=4]="error",u[u.silent=5]="silent",(d=P||(P={})).Default="livekit",d.Room="livekit-room",d.Participant="livekit-participant",d.Track="livekit-track",d.Publication="livekit-track-publication",d.Engine="livekit-engine",d.Signal="livekit-signal",d.PCManager="livekit-pc-manager",d.PCTransport="livekit-pc-transport",d.E2EE="lk-e2ee";let ea=er.getLogger("livekit");function es(e){let t=er.getLogger(e);return t.setDefaultLevel(ea.getLevel()),t}Object.values(P).map(e=>er.getLogger(e)),ea.setDefaultLevel(R.info);let eo=er.getLogger("lk-e2ee");function ec(e,t){if(!e)throw Error(t)}function el(e){if("number"!=typeof e)throw Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw Error("invalid int 32: "+e)}function eu(e){if("number"!=typeof e)throw Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw Error("invalid uint 32: "+e)}function ed(e){if("number"!=typeof e)throw Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw Error("invalid float 32: "+e)}let eh=Symbol("@bufbuild/protobuf/enum-type");function ef(e,t,n,i){e[eh]=ep(t,n.map(t=>({no:t.no,name:t.name,localName:e[t.no]})))}function ep(e,t,n){let i=Object.create(null),r=Object.create(null),a=[];for(let e of t){let t=ey(e);a.push(t),i[e.name]=t,r[e.no]=t}return{typeName:e,values:a,findName:e=>i[e],findNumber:e=>r[e]}}function ey(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class em{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){let n=this.getType().runtime.bin,i=n.makeReadOptions(t);return n.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){let n=this.getType(),i=n.runtime.json,r=i.makeReadOptions(t);return i.readMessage(n,e,r,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(e){throw Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(e instanceof Error?e.message:String(e)))}return this.fromJson(n,t)}toBinary(e){let t=this.getType().runtime.bin,n=t.makeWriteOptions(e),i=n.writerFactory();return t.writeMessage(this,i,n),i.finish()}toJson(e){let t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}toJsonString(e){var t;return JSON.stringify(this.toJson(e),null,null!==(t=null==e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function eg(){let e=0,t=0;for(let n=0;n<28;n+=7){let i=this.buf[this.pos++];if(e|=(127&i)<<n,(128&i)==0)return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,(128&n)==0)return this.assertBounds(),[e,t];for(let n=3;n<=31;n+=7){let i=this.buf[this.pos++];if(t|=(127&i)<<n,(128&i)==0)return this.assertBounds(),[e,t]}throw Error("invalid varint")}function eb(e,t,n){for(let i=0;i<28;i+=7){let r=e>>>i,a=!(r>>>7==0&&0==t),s=(a?128|r:r)&255;if(n.push(s),!a)return}let i=e>>>28&15|(7&t)<<4,r=t>>3!=0;if(n.push((r?128|i:i)&255),r){for(let e=3;e<31;e+=7){let i=t>>>e,r=i>>>7!=0,a=(r?128|i:i)&255;if(n.push(a),!r)return}n.push(t>>>31&1)}}function ev(e){let t="-"===e[0];t&&(e=e.slice(1));let n=0,i=0;function r(t,r){let a=Number(e.slice(t,r));i*=1e6,(n=1e6*n+a)>=4294967296&&(i+=n/4294967296|0,n%=4294967296)}return r(-24,-18),r(-18,-12),r(-12,-6),r(-6),t?eS(n,i):ew(n,i)}function ek(e,t){if({lo:e,hi:t}={lo:e>>>0,hi:t>>>0},t<=2097151)return String(4294967296*t+e);let n=16777215&e,i=(e>>>24|t<<8)&16777215,r=t>>16&65535,a=n+6777216*i+6710656*r,s=i+8147497*r,o=2*r;return a>=1e7&&(s+=Math.floor(a/1e7),a%=1e7),s>=1e7&&(o+=Math.floor(s/1e7),s%=1e7),o.toString()+eT(s)+eT(a)}function ew(e,t){return{lo:0|e,hi:0|t}}function eS(e,t){return t=~t,e?e=~e+1:t+=1,ew(e,t)}let eT=e=>{let t=String(e);return"0000000".slice(t.length)+t};function eI(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function eE(){let e=this.buf[this.pos++],t=127&e;if((128&e)==0||(t|=(127&(e=this.buf[this.pos++]))<<7,(128&e)==0)||(t|=(127&(e=this.buf[this.pos++]))<<14,(128&e)==0)||(t|=(127&(e=this.buf[this.pos++]))<<21,(128&e)==0))return this.assertBounds(),t;t|=(15&(e=this.buf[this.pos++]))<<28;for(let t=5;(128&e)!=0&&t<10;t++)e=this.buf[this.pos++];if((128&e)!=0)throw Error("invalid varint");return this.assertBounds(),t>>>0}let eN=function(){let e=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=typeof ee||"object"!=typeof ee.env||"1"!==ee.env.BUF_BIGINT_DISABLE)){let t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),i=BigInt("0"),r=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){let i="bigint"==typeof e?e:BigInt(e);if(i>n||i<t)throw Error("int64 invalid: ".concat(e));return i},uParse(e){let t="bigint"==typeof e?e:BigInt(e);if(t>r||t<i)throw Error("uint64 invalid: ".concat(e));return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}let t=e=>ec(/^-?[0-9]+$/.test(e),"int64 invalid: ".concat(e)),n=e=>ec(/^[0-9]+$/.test(e),"uint64 invalid: ".concat(e));return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),t(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),n(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),t(e),ev(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),n(e),ev(e)),dec:(e,t)=>(function(e,t){let n=ew(e,t),i=2147483648&n.hi;i&&(n=eS(n.lo,n.hi));let r=ek(n.lo,n.hi);return i?"-"+r:r})(e,t),uDec:(e,t)=>ek(e,t)}}();function eC(e,t,n){if(t===n)return!0;if(e==x.BYTES){if(!(t instanceof Uint8Array)||!(n instanceof Uint8Array)||t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}switch(e){case x.UINT64:case x.FIXED64:case x.INT64:case x.SFIXED64:case x.SINT64:return t==n}return!1}function eA(e,t){switch(e){case x.BOOL:return!1;case x.UINT64:case x.FIXED64:case x.INT64:case x.SFIXED64:case x.SINT64:return 0==t?eN.zero:"0";case x.DOUBLE:case x.FLOAT:return 0;case x.BYTES:return new Uint8Array(0);case x.STRING:return"";default:return 0}}function eL(e,t){switch(e){case x.BOOL:return!1===t;case x.STRING:return""===t;case x.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return 0==t}}(h=x||(x={}))[h.DOUBLE=1]="DOUBLE",h[h.FLOAT=2]="FLOAT",h[h.INT64=3]="INT64",h[h.UINT64=4]="UINT64",h[h.INT32=5]="INT32",h[h.FIXED64=6]="FIXED64",h[h.FIXED32=7]="FIXED32",h[h.BOOL=8]="BOOL",h[h.STRING=9]="STRING",h[h.BYTES=12]="BYTES",h[h.UINT32=13]="UINT32",h[h.SFIXED32=15]="SFIXED32",h[h.SFIXED64=16]="SFIXED64",h[h.SINT32=17]="SINT32",h[h.SINT64=18]="SINT64",(f=_||(_={}))[f.BIGINT=0]="BIGINT",f[f.STRING=1]="STRING",(p=B||(B={}))[p.Varint=0]="Varint",p[p.Bit64=1]="Bit64",p[p.LengthDelimited=2]="LengthDelimited",p[p.StartGroup=3]="StartGroup",p[p.EndGroup=4]="EndGroup",p[p.Bit32=5]="Bit32";class eO{constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),n=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],n),n+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(eu(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return el(e),eI(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){ed(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){eu(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){el(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return el(e),eI(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=eN.enc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=eN.uEnc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=eN.enc(e);return eb(t.lo,t.hi,this.buf),this}sint64(e){let t=eN.enc(e),n=t.hi>>31;return eb(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=eN.uEnc(e);return eb(t.lo,t.hi,this.buf),this}}class eU{constructor(e,t){this.varint64=eg,this.uint32=eE,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case B.Varint:for(;128&this.buf[this.pos++];);break;case B.Bit64:this.pos+=4;case B.Bit32:this.pos+=4;break;case B.LengthDelimited:let i=this.uint32();this.pos+=i;break;case B.StartGroup:for(;;){let[e,n]=this.tag();if(n===B.EndGroup){if(void 0!==t&&e!==t)throw Error("invalid end group tag");break}this.skip(n,e)}break;default:throw Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return eN.dec(...this.varint64())}uint64(){return eN.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,eN.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return eN.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return eN.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function eF(e){let t=e.field.localName,n=Object.create(null);return n[t]=function(e){let t=e.field;if(t.repeated)return[];if(void 0!==t.default)return t.default;switch(t.kind){case"enum":return t.T.values[0].no;case"scalar":return eA(t.T,t.L);case"message":let n=t.T,i=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(i):i;case"map":throw"map fields are not allowed to be extensions"}}(e),[n,()=>n[t]]}let eD="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),eR=[];for(let e=0;e<eD.length;e++)eR[eD[e].charCodeAt(0)]=e;eR["-".charCodeAt(0)]=eD.indexOf("+"),eR["_".charCodeAt(0)]=eD.indexOf("/");let eP={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n=new Uint8Array(t),i=0,r=0,a,s=0;for(let t=0;t<e.length;t++){if(void 0===(a=eR[e.charCodeAt(t)]))switch(e[t]){case"=":r=0;case"\n":case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:s=a,r=1;break;case 1:n[i++]=s<<2|(48&a)>>4,s=a,r=2;break;case 2:n[i++]=(15&s)<<4|(60&a)>>2,s=a,r=3;break;case 3:n[i++]=(3&s)<<6|a,r=0}}if(1==r)throw Error("invalid base64 string.");return n.subarray(0,i)},enc(e){let t="",n=0,i,r=0;for(let a=0;a<e.length;a++)switch(i=e[a],n){case 0:t+=eD[i>>2],r=(3&i)<<4,n=1;break;case 1:t+=eD[r|i>>4],r=(15&i)<<2,n=2;break;case 2:t+=eD[r|i>>6]+eD[63&i],n=0}return n&&(t+=eD[r]+"=",1==n&&(t+="=")),t}};function ex(e,t){let n=e.getType();return t.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(e).find(e=>e.no==t.field.no)}function e_(e,t){ec(e.extendee.typeName==t.getType().typeName,"extension ".concat(e.typeName," can only be applied to message ").concat(e.extendee.typeName))}function eB(e,t){let n=e.localName;if(e.repeated)return t[n].length>0;if(e.oneof)return t[e.oneof.localName].case===n;switch(e.kind){case"enum":case"scalar":if(e.opt||e.req)return void 0!==t[n];if("enum"==e.kind)return t[n]!==e.T.values[0].no;return!eL(e.T,t[n]);case"message":return void 0!==t[n];case"map":return Object.keys(t[n]).length>0}}function eM(e,t){let n=e.localName,i=!e.opt&&!e.req;if(e.repeated)t[n]=[];else if(e.oneof)t[e.oneof.localName]={case:void 0};else switch(e.kind){case"map":t[n]={};break;case"enum":t[n]=i?e.T.values[0].no:void 0;break;case"scalar":t[n]=i?eA(e.T,e.L):void 0;break;case"message":t[n]=void 0}}function eK(e,t){if(null===e||"object"!=typeof e||!Object.getOwnPropertyNames(em.prototype).every(t=>t in e&&"function"==typeof e[t]))return!1;let n=e.getType();return null!==n&&"function"==typeof n&&"typeName"in n&&"string"==typeof n.typeName&&(void 0===t||n.typeName==t.typeName)}function eV(e,t){return eK(t)||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}x.DOUBLE,x.FLOAT,x.INT64,x.UINT64,x.INT32,x.UINT32,x.BOOL,x.STRING,x.BYTES;let ej={ignoreUnknownFields:!1},eG={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},eJ=Symbol(),eq=Symbol();function eX(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return String(e)}}function eW(e,t,n,i,r){let a=n.localName;if(n.repeated){if(ec("map"!=n.kind),null===t)return;if(!Array.isArray(t))throw Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(eX(t)));let s=e[a];for(let e of t){if(null===e)throw Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(eX(e)));switch(n.kind){case"message":s.push(n.T.fromJson(e,i));break;case"enum":let t=eY(n.T,e,i.ignoreUnknownFields,!0);t!==eq&&s.push(t);break;case"scalar":try{s.push(eH(n.T,e,n.L,!0))}catch(i){let t="cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(eX(e));throw i instanceof Error&&i.message.length>0&&(t+=": ".concat(i.message)),Error(t)}}}}else if("map"==n.kind){if(null===t)return;if("object"!=typeof t||Array.isArray(t))throw Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(eX(t)));let s=e[a];for(let[e,a]of Object.entries(t)){let o;if(null===a)throw Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: map value null"));try{o=function(e,t){if(e===x.BOOL)switch(t){case"true":t=!0;break;case"false":t=!1}return eH(e,t,_.BIGINT,!0).toString()}(n.K,e)}catch(i){let e="cannot decode map key for field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(eX(t));throw i instanceof Error&&i.message.length>0&&(e+=": ".concat(i.message)),Error(e)}switch(n.V.kind){case"message":s[o]=n.V.T.fromJson(a,i);break;case"enum":let c=eY(n.V.T,a,i.ignoreUnknownFields,!0);c!==eq&&(s[o]=c);break;case"scalar":try{s[o]=eH(n.V.T,a,_.BIGINT,!0)}catch(i){let e="cannot decode map value for field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(eX(t));throw i instanceof Error&&i.message.length>0&&(e+=": ".concat(i.message)),Error(e)}}}}else switch(n.oneof&&(e=e[n.oneof.localName]={case:a},a="value"),n.kind){case"message":let s=n.T;if(null===t&&"google.protobuf.Value"!=s.typeName)return;let o=e[a];eK(o)?o.fromJson(t,i):(e[a]=o=s.fromJson(t,i),s.fieldWrapper&&!n.oneof&&(e[a]=s.fieldWrapper.unwrapField(o)));break;case"enum":let c=eY(n.T,t,i.ignoreUnknownFields,!1);switch(c){case eJ:eM(n,e);break;case eq:break;default:e[a]=c}break;case"scalar":try{let i=eH(n.T,t,n.L,!1);i===eJ?eM(n,e):e[a]=i}catch(i){let e="cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(eX(t));throw i instanceof Error&&i.message.length>0&&(e+=": ".concat(i.message)),Error(e)}}}function eH(e,t,n,i){if(null===t)return i?eA(e,n):eJ;switch(e){case x.DOUBLE:case x.FLOAT:if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t||"string"==typeof t&&t.trim().length!==t.length||"string"!=typeof t&&"number"!=typeof t)break;let r=Number(t);if(Number.isNaN(r)||!Number.isFinite(r))break;return e==x.FLOAT&&ed(r),r;case x.INT32:case x.FIXED32:case x.SFIXED32:case x.SINT32:case x.UINT32:let a;if("number"==typeof t?a=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(a=Number(t)),void 0===a)break;return e==x.UINT32||e==x.FIXED32?eu(a):el(a),a;case x.INT64:case x.SFIXED64:case x.SINT64:if("number"!=typeof t&&"string"!=typeof t)break;let s=eN.parse(t);return n?s.toString():s;case x.FIXED64:case x.UINT64:if("number"!=typeof t&&"string"!=typeof t)break;let o=eN.uParse(t);return n?o.toString():o;case x.BOOL:if("boolean"!=typeof t)break;return t;case x.STRING:if("string"!=typeof t)break;try{encodeURIComponent(t)}catch(e){throw Error("invalid UTF8")}return t;case x.BYTES:if(""===t)return new Uint8Array(0);if("string"!=typeof t)break;return eP.dec(t)}throw Error()}function eY(e,t,n,i){if(null===t)return"google.protobuf.NullValue"==e.typeName?0:i?e.values[0].no:eJ;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":let r=e.findName(t);if(void 0!==r)return r.no;if(n)return eq}throw Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(eX(t)))}function ez(e,t,n){if("map"==e.kind){ec("object"==typeof t&&null!=t);let i={},r=Object.entries(t);switch(e.V.kind){case"scalar":for(let[t,n]of r)i[t.toString()]=e$(e.V.T,n);break;case"message":for(let[e,t]of r)i[e.toString()]=t.toJson(n);break;case"enum":let a=e.V.T;for(let[e,t]of r)i[e.toString()]=eQ(a,t,n.enumAsInteger)}return n.emitDefaultValues||r.length>0?i:void 0}if(e.repeated){ec(Array.isArray(t));let i=[];switch(e.kind){case"scalar":for(let n=0;n<t.length;n++)i.push(e$(e.T,t[n]));break;case"enum":for(let r=0;r<t.length;r++)i.push(eQ(e.T,t[r],n.enumAsInteger));break;case"message":for(let e=0;e<t.length;e++)i.push(t[e].toJson(n))}return n.emitDefaultValues||i.length>0?i:void 0}switch(e.kind){case"scalar":return e$(e.T,t);case"enum":return eQ(e.T,t,n.enumAsInteger);case"message":return eV(e.T,t).toJson(n)}}function eQ(e,t,n){var i;if(ec("number"==typeof t),"google.protobuf.NullValue"==e.typeName)return null;if(n)return t;let r=e.findNumber(t);return null!==(i=null==r?void 0:r.name)&&void 0!==i?i:t}function e$(e,t){switch(e){case x.INT32:case x.SFIXED32:case x.SINT32:case x.FIXED32:case x.UINT32:return ec("number"==typeof t),t;case x.FLOAT:case x.DOUBLE:if(ec("number"==typeof t),Number.isNaN(t))return"NaN";if(t===Number.POSITIVE_INFINITY)return"Infinity";if(t===Number.NEGATIVE_INFINITY)return"-Infinity";return t;case x.STRING:return ec("string"==typeof t),t;case x.BOOL:return ec("boolean"==typeof t),t;case x.UINT64:case x.FIXED64:case x.INT64:case x.SFIXED64:case x.SINT64:return ec("bigint"==typeof t||"string"==typeof t||"number"==typeof t),t.toString();case x.BYTES:return ec(t instanceof Uint8Array),eP.enc(t)}}let eZ=Symbol("@bufbuild/protobuf/unknown-fields"),e0={readUnknownFields:!0,readerFactory:e=>new eU(e)},e2={writeUnknownFields:!0,writerFactory:()=>new eO};function e1(e,t,n,i,r){let{repeated:a,localName:s}=n;switch(n.oneof&&((e=e[n.oneof.localName]).case!=s&&delete e.value,e.case=s,s="value"),n.kind){case"scalar":case"enum":let o="enum"==n.kind?x.INT32:n.T,c=e6;if("scalar"==n.kind&&n.L>0&&(c=e4),a){let n=e[s];if(i==B.LengthDelimited&&o!=x.STRING&&o!=x.BYTES){let e=t.uint32()+t.pos;for(;t.pos<e;)n.push(c(t,o))}else n.push(c(t,o))}else e[s]=c(t,o);break;case"message":let l=n.T;a?e[s].push(e3(t,new l,r,n)):eK(e[s])?e3(t,e[s],r,n):(e[s]=e3(t,new l,r,n),!l.fieldWrapper||n.oneof||n.repeated||(e[s]=l.fieldWrapper.unwrapField(e[s])));break;case"map":let[u,d]=function(e,t,n){let i,r;let a=t.uint32(),s=t.pos+a;for(;t.pos<s;){let[a]=t.tag();switch(a){case 1:i=e6(t,e.K);break;case 2:switch(e.V.kind){case"scalar":r=e6(t,e.V.T);break;case"enum":r=t.int32();break;case"message":r=e3(t,new e.V.T,n,void 0)}}}if(void 0===i&&(i=eA(e.K,_.BIGINT)),"string"!=typeof i&&"number"!=typeof i&&(i=i.toString()),void 0===r)switch(e.V.kind){case"scalar":r=eA(e.V.T,_.BIGINT);break;case"enum":r=e.V.T.values[0].no;break;case"message":r=new e.V.T}return[i,r]}(n,t,r);e[s][u]=d}}function e3(e,t,n,i){let r=t.getType().runtime.bin,a=null==i?void 0:i.delimited;return r.readMessage(t,e,a?i.no:e.uint32(),n,a),t}function e4(e,t){let n=e6(e,t);return"bigint"==typeof n?n.toString():n}function e6(e,t){switch(t){case x.STRING:return e.string();case x.BOOL:return e.bool();case x.DOUBLE:return e.double();case x.FLOAT:return e.float();case x.INT32:return e.int32();case x.INT64:return e.int64();case x.UINT64:return e.uint64();case x.FIXED64:return e.fixed64();case x.BYTES:return e.bytes();case x.FIXED32:return e.fixed32();case x.SFIXED32:return e.sfixed32();case x.SFIXED64:return e.sfixed64();case x.SINT64:return e.sint64();case x.UINT32:return e.uint32();case x.SINT32:return e.sint32()}}function e8(e,t,n,i){ec(void 0!==t);let r=e.repeated;switch(e.kind){case"scalar":case"enum":let a="enum"==e.kind?x.INT32:e.T;if(r){if(ec(Array.isArray(t)),e.packed)!function(e,t,n,i){if(!i.length)return;e.tag(n,B.LengthDelimited).fork();let[,r]=e9(t);for(let t=0;t<i.length;t++)e[r](i[t]);e.join()}(n,a,e.no,t);else for(let i of t)e7(n,a,e.no,i)}else e7(n,a,e.no,t);break;case"message":if(r)for(let r of(ec(Array.isArray(t)),t))e5(n,i,e,r);else e5(n,i,e,t);break;case"map":for(let[r,a]of(ec("object"==typeof t&&null!=t),Object.entries(t)))!function(e,t,n,i,r){e.tag(n.no,B.LengthDelimited),e.fork();let a=i;switch(n.K){case x.INT32:case x.FIXED32:case x.UINT32:case x.SFIXED32:case x.SINT32:a=Number.parseInt(i);break;case x.BOOL:ec("true"==i||"false"==i),a="true"==i}switch(e7(e,n.K,1,a),n.V.kind){case"scalar":e7(e,n.V.T,2,r);break;case"enum":e7(e,x.INT32,2,r);break;case"message":ec(void 0!==r),e.tag(2,B.LengthDelimited).bytes(r.toBinary(t))}e.join()}(n,i,e,r,a)}}function e5(e,t,n,i){let r=eV(n.T,i);n.delimited?e.tag(n.no,B.StartGroup).raw(r.toBinary(t)).tag(n.no,B.EndGroup):e.tag(n.no,B.LengthDelimited).bytes(r.toBinary(t))}function e7(e,t,n,i){ec(void 0!==i);let[r,a]=e9(t);e.tag(n,r)[a](i)}function e9(e){let t=B.Varint;switch(e){case x.BYTES:case x.STRING:t=B.LengthDelimited;break;case x.DOUBLE:case x.FIXED64:case x.SFIXED64:t=B.Bit64;break;case x.FIXED32:case x.SFIXED32:case x.FLOAT:t=B.Bit32}return[t,x[e].toLowerCase()]}function te(e){if(void 0===e)return e;if(eK(e))return e.clone();if(e instanceof Uint8Array){let t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function tt(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class tn{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){let e={};for(let t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){let e={};for(let t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){let e;this.members=[];let t=this.members;for(let n of this.list())n.oneof?n.oneof!==e&&(e=n.oneof,t.push(e)):t.push(n)}return this.members}}function ti(e,t){let n=ta(e);return t?n:tu(tl(n))}let tr=ta;function ta(e){let t=!1,n=[];for(let i=0;i<e.length;i++){let r=e.charAt(i);switch(r){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(r),t=!1;break;default:t&&(t=!1,r=r.toUpperCase()),n.push(r)}}return n.join("")}let ts=new Set(["constructor","toString","toJSON","valueOf"]),to=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),tc=e=>"".concat(e,"$"),tl=e=>to.has(e)?tc(e):e,tu=e=>ts.has(e)?tc(e):e;class td{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=ti(e,!1)}addField(e){ec(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}let th=(y=e=>new tn(e,e=>(function(e,t){var n,i,r,a,s,o;let c;let l=[];for(let t of"function"==typeof e?e():e){if(t.localName=ti(t.name,void 0!==t.oneof),t.jsonName=null!==(n=t.jsonName)&&void 0!==n?n:tr(t.name),t.repeated=null!==(i=t.repeated)&&void 0!==i&&i,"scalar"==t.kind&&(t.L=null!==(r=t.L)&&void 0!==r?r:_.BIGINT),t.delimited=null!==(a=t.delimited)&&void 0!==a&&a,t.req=null!==(s=t.req)&&void 0!==s&&s,t.opt=null!==(o=t.opt)&&void 0!==o&&o,void 0===t.packed&&(t.packed="enum"==t.kind||"scalar"==t.kind&&t.T!=x.BYTES&&t.T!=x.STRING),void 0!==t.oneof){let e="string"==typeof t.oneof?t.oneof:t.oneof.name;c&&c.name==e||(c=new td(e)),t.oneof=c,c.addField(t)}l.push(t)}return l})(e)),m=e=>{for(let t of e.getType().fields.byMember()){if(t.opt)continue;let n=t.localName;if(t.repeated){e[n]=[];continue}switch(t.kind){case"oneof":e[n]={case:void 0};break;case"enum":e[n]=0;break;case"map":e[n]={};break;case"scalar":e[n]=eA(t.T,t.L)}}},{syntax:"proto3",json:{makeReadOptions:function(e){return e?Object.assign(Object.assign({},ej),e):ej},makeWriteOptions:function(e){return e?Object.assign(Object.assign({},eG),e):eG},readMessage(e,t,n,i){if(null==t||Array.isArray(t)||"object"!=typeof t)throw Error("cannot decode message ".concat(e.typeName," from JSON: ").concat(eX(t)));i=null!=i?i:new e;let r=new Map,a=n.typeRegistry;for(let[s,o]of Object.entries(t)){let t=e.fields.findJsonName(s);if(t){if(t.oneof){if(null===o&&"scalar"==t.kind)continue;let n=r.get(t.oneof);if(void 0!==n)throw Error("cannot decode message ".concat(e.typeName,' from JSON: multiple keys for oneof "').concat(t.oneof.name,'" present: "').concat(n,'", "').concat(s,'"'));r.set(t.oneof,s)}eW(i,o,t,n,e)}else{let t=!1;if((null==a?void 0:a.findExtension)&&s.startsWith("[")&&s.endsWith("]")){let r=a.findExtension(s.substring(1,s.length-1));if(r&&r.extendee.typeName==e.typeName){t=!0;let[e,a]=eF(r);eW(e,o,r.field,n,r),function(e,t,n,i){e_(t,e);let r=t.runtime.bin.makeReadOptions(i),a=t.runtime.bin.makeWriteOptions(i);if(ex(e,t)){let n=e.getType().runtime.bin.listUnknownFields(e).filter(e=>e.no!=t.field.no);for(let t of(e.getType().runtime.bin.discardUnknownFields(e),n))e.getType().runtime.bin.onUnknownField(e,t.no,t.wireType,t.data)}let s=a.writerFactory(),o=t.field;o.opt||o.repeated||"enum"!=o.kind&&"scalar"!=o.kind||(o=Object.assign(Object.assign({},t.field),{opt:!0})),t.runtime.bin.writeField(o,n,s,a);let c=r.readerFactory(s.finish());for(;c.pos<c.len;){let[t,n]=c.tag(),i=c.skip(n,t);e.getType().runtime.bin.onUnknownField(e,t,n,i)}}(i,r,a(),n)}}if(!t&&!n.ignoreUnknownFields)throw Error("cannot decode message ".concat(e.typeName,' from JSON: key "').concat(s,'" is unknown'))}}return i},writeMessage(e,t){let n;let i=e.getType(),r={};try{for(n of i.fields.byNumber()){if(!eB(n,e)){var a;if(n.req)throw"required field not set";if(!t.emitDefaultValues||!((a=n).repeated||"map"==a.kind||!a.oneof&&"message"!=a.kind&&!a.opt&&!a.req))continue}let i=n.oneof?e[n.oneof.localName].value:e[n.localName],s=ez(n,i,t);void 0!==s&&(r[t.useProtoFieldName?n.name:n.jsonName]=s)}let s=t.typeRegistry;if(null==s?void 0:s.findExtensionFor)for(let n of i.runtime.bin.listUnknownFields(e)){let a=s.findExtensionFor(i.typeName,n.no);if(a&&ex(e,a)){let n=function(e,t,n){e_(t,e);let i=t.runtime.bin.makeReadOptions(n),r=function(e,t){if(!t.repeated&&("enum"==t.kind||"scalar"==t.kind)){for(let n=e.length-1;n>=0;--n)if(e[n].no==t.no)return[e[n]];return[]}return e.filter(e=>e.no===t.no)}(e.getType().runtime.bin.listUnknownFields(e),t.field),[a,s]=eF(t);for(let e of r)t.runtime.bin.readField(a,i.readerFactory(e.data),t.field,e.wireType,i);return s()}(e,a,t),i=ez(a.field,n,t);void 0!==i&&(r[a.field.jsonName]=i)}}}catch(r){let e=n?"cannot encode field ".concat(i.typeName,".").concat(n.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),t=r instanceof Error?r.message:String(r);throw Error(e+(t.length>0?": ".concat(t):""))}return r},readScalar:(e,t,n)=>eH(e,t,null!=n?n:_.BIGINT,!0),writeScalar(e,t,n){if(void 0!==t&&(n||eL(e,t)))return e$(e,t)},debug:eX},bin:{makeReadOptions:function(e){return e?Object.assign(Object.assign({},e0),e):e0},makeWriteOptions:function(e){return e?Object.assign(Object.assign({},e2),e):e2},listUnknownFields(e){var t;return null!==(t=e[eZ])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[eZ]},writeUnknownFields(e,t){let n=e[eZ];if(n)for(let e of n)t.tag(e.no,e.wireType).raw(e.data)},onUnknownField(e,t,n,i){Array.isArray(e[eZ])||(e[eZ]=[]),e[eZ].push({no:t,wireType:n,data:i})},readMessage(e,t,n,i,r){let a,s;let o=e.getType(),c=r?t.len:t.pos+n;for(;t.pos<c&&([a,s]=t.tag(),!0!==r||s!=B.EndGroup);){let n=o.fields.find(a);if(!n){let n=t.skip(s,a);i.readUnknownFields&&this.onUnknownField(e,a,s,n);continue}e1(e,t,n,s,i)}if(r&&(s!=B.EndGroup||a!==n))throw Error("invalid end group tag")},readField:e1,writeMessage(e,t,n){let i=e.getType();for(let r of i.fields.byNumber()){if(!eB(r,e)){if(r.req)throw Error("cannot encode field ".concat(i.typeName,".").concat(r.name," to binary: required field not set"));continue}let a=r.oneof?e[r.oneof.localName].value:e[r.localName];e8(r,a,t,n)}return n.writeUnknownFields&&this.writeUnknownFields(e,t),t},writeField(e,t,n,i){void 0!==t&&e8(e,t,n,i)}},util:Object.assign(Object.assign({},{setEnumType:ef,initPartial(e,t){if(void 0!==e)for(let n of t.getType().fields.byMember()){let i=n.localName;if(null!=e[i])switch(n.kind){case"oneof":let r=e[i].case;if(void 0===r)continue;let a=n.findField(r),s=e[i].value;a&&"message"==a.kind&&!eK(s,a.T)?s=new a.T(s):a&&"scalar"===a.kind&&a.T===x.BYTES&&(s=tt(s)),t[i]={case:r,value:s};break;case"scalar":case"enum":let o=e[i];n.T===x.BYTES&&(o=n.repeated?o.map(tt):tt(o)),t[i]=o;break;case"map":switch(n.V.kind){case"scalar":case"enum":if(n.V.T===x.BYTES)for(let[n,r]of Object.entries(e[i]))t[i][n]=tt(r);else Object.assign(t[i],e[i]);break;case"message":let c=n.V.T;for(let n of Object.keys(e[i])){let r=e[i][n];c.fieldWrapper||(r=new c(r)),t[i][n]=r}}break;case"message":let l=n.T;if(n.repeated)t[i]=e[i].map(e=>eK(e,l)?e:new l(e));else{let n=e[i];l.fieldWrapper?"google.protobuf.BytesValue"===l.typeName?t[i]=tt(n):t[i]=n:t[i]=eK(n,l)?n:new l(n)}}}},equals:(e,t,n)=>t===n||!!t&&!!n&&e.fields.byMember().every(e=>{let i=t[e.localName],r=n[e.localName];if(e.repeated){if(i.length!==r.length)return!1;switch(e.kind){case"message":return i.every((t,n)=>e.T.equals(t,r[n]));case"scalar":return i.every((t,n)=>eC(e.T,t,r[n]));case"enum":return i.every((e,t)=>eC(x.INT32,e,r[t]))}throw Error("repeated cannot contain ".concat(e.kind))}switch(e.kind){case"message":return e.T.equals(i,r);case"enum":return eC(x.INT32,i,r);case"scalar":return eC(e.T,i,r);case"oneof":if(i.case!==r.case)return!1;let a=e.findField(i.case);if(void 0===a)return!0;switch(a.kind){case"message":return a.T.equals(i.value,r.value);case"enum":return eC(x.INT32,i.value,r.value);case"scalar":return eC(a.T,i.value,r.value)}throw Error("oneof cannot contain ".concat(a.kind));case"map":let s=Object.keys(i).concat(Object.keys(r));switch(e.V.kind){case"message":let o=e.V.T;return s.every(e=>o.equals(i[e],r[e]));case"enum":return s.every(e=>eC(x.INT32,i[e],r[e]));case"scalar":let c=e.V.T;return s.every(e=>eC(c,i[e],r[e]))}}}),clone(e){let t=e.getType(),n=new t;for(let i of t.fields.byMember()){let t;let r=e[i.localName];if(i.repeated)t=r.map(te);else if("map"==i.kind)for(let[e,a]of(t=n[i.localName],Object.entries(r)))t[e]=te(a);else t="oneof"==i.kind?i.findField(r.case)?{case:r.case,value:te(r.value)}:{case:void 0}:te(r);n[i.localName]=t}for(let i of t.runtime.bin.listUnknownFields(e))t.runtime.bin.onUnknownField(n,i.no,i.wireType,i.data);return n}}),{newFieldList:y,initFields:m}),makeMessageType(e,t,n){return function(e,t,n,i){var r;let a=null!==(r=null==i?void 0:i.localName)&&void 0!==r?r:t.substring(t.lastIndexOf(".")+1),s={[a]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[a];return Object.setPrototypeOf(s.prototype,new em),Object.assign(s,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:(e,t)=>new s().fromBinary(e,t),fromJson:(e,t)=>new s().fromJson(e,t),fromJsonString:(e,t)=>new s().fromJsonString(e,t),equals:(t,n)=>e.util.equals(s,t,n)}),s}(this,e,t,n)},makeEnum:function(e,t,n){let i={};for(let e of t){let t=ey(e);i[t.localName]=t.no,i[t.no]=t.localName}return ef(i,e,t),i},makeEnumType:ep,getEnumType:function(e){let t=e[eh];return ec(t,"missing enum type on enum object"),t},makeExtension(e,t,n){var i;let r;return i=this,{typeName:e,extendee:t,get field(){if(!r){let t="function"==typeof n?n():n;t.name=e.split(".").pop(),t.jsonName="[".concat(e,"]"),r=i.util.newFieldList([t]).list()[0]}return r},runtime:i}}}),tf=th.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),tp=th.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),ty=th.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),tm=/version\/(\d+(\.?_?\d+)+)/i;function tg(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if("undefined"==typeof navigator)return;let n=navigator.userAgent.toLowerCase();if(void 0===i||t){let e=tb.find(e=>{let{test:t}=e;return t.test(n)});i=null==e?void 0:e.describe(n)}return i}let tb=[{test:/firefox|iceweasel|fxios/i,describe:e=>({name:"Firefox",version:tv(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:tk(e)})},{test:/chrom|crios|crmo/i,describe:e=>({name:"Chrome",version:tv(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("crios")?"iOS":void 0,osVersion:tk(e)})},{test:/safari|applewebkit/i,describe:e=>({name:"Safari",version:tv(tm,e),os:e.includes("mobile/")?"iOS":"macOS",osVersion:tk(e)})}];function tv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=t.match(e);return i&&i.length>=n&&i[n]||""}function tk(e){return e.includes("mac os")?tv(/\(.+?(\d+_\d+(:?_\d+)?)/,e,1).replace(/_/g,"."):void 0}class tw{constructor(e,t,n,i,r){if("object"==typeof e)this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(void 0!==t&&void 0!==n)this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:n,maxFramerate:i,priority:r};else throw TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}(g=M||(M={})).telephone={maxBitrate:12e3},g.speech={maxBitrate:2e4},g.music={maxBitrate:32e3},g.musicStereo={maxBitrate:48e3},g.musicHighQuality={maxBitrate:64e3},g.musicHighQualityStereo={maxBitrate:96e3},new tw(160,90,9e4,20),new tw(320,180,16e4,20),new tw(384,216,18e4,20),new tw(640,360,45e4,20),new tw(960,540,8e5,25),new tw(1280,720,17e5,30),new tw(1920,1080,3e6,30),new tw(2560,1440,5e6,30),new tw(3840,2160,8e6,30),new tw(160,120,7e4,20),new tw(240,180,125e3,20),new tw(320,240,14e4,20),new tw(480,360,33e4,20),new tw(640,480,5e5,20),new tw(720,540,6e5,25),new tw(960,720,13e5,30),new tw(1440,1080,23e5,30),new tw(1920,1440,38e5,30),new tw(640,360,2e5,3,"medium"),new tw(640,360,4e5,15,"medium"),new tw(1280,720,8e5,5,"medium"),new tw(1280,720,15e5,15,"medium"),new tw(1280,720,2e6,30,"medium"),new tw(1920,1080,25e5,15,"medium"),new tw(1920,1080,5e6,30,"medium"),new tw(0,0,7e6,30,"medium");var tS={exports:{}},tT="object"==typeof Reflect?Reflect:null,tI=tT&&"function"==typeof tT.apply?tT.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};K=tT&&"function"==typeof tT.ownKeys?tT.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var tE=Number.isNaN||function(e){return e!=e};function tN(){tN.init.call(this)}tS.exports=tN,tS.exports.once=function(e,t){return new Promise(function(n,i){var r;function a(n){e.removeListener(t,s),i(n)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",a),n([].slice.call(arguments))}tx(e,t,s,{once:!0}),"error"!==t&&(r={once:!0},"function"==typeof e.on&&tx(e,"error",a,r))})},tN.EventEmitter=tN,tN.prototype._events=void 0,tN.prototype._eventsCount=0,tN.prototype._maxListeners=void 0;var tC=10;function tA(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function tL(e){return void 0===e._maxListeners?tN.defaultMaxListeners:e._maxListeners}function tO(e,t,n,i){if(tA(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),s=a[t]),void 0===s)s=a[t]=n,++e._eventsCount;else if("function"==typeof s?s=a[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(r=tL(e))>0&&s.length>r&&!s.warned){s.warned=!0;var r,a,s,o=Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,console&&console.warn&&console.warn(o)}return e}function tU(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function tF(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=tU.bind(i);return r.listener=n,i.wrapFn=r,r}function tD(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):tP(r,r.length)}function tR(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function tP(e,t){for(var n=Array(t),i=0;i<t;++i)n[i]=e[i];return n}function tx(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else if("function"==typeof e.addEventListener)e.addEventListener(t,function r(a){i.once&&e.removeEventListener(t,r),n(a)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(tN,"defaultMaxListeners",{enumerable:!0,get:function(){return tC},set:function(e){if("number"!=typeof e||e<0||tE(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");tC=e}}),tN.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},tN.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||tE(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},tN.prototype.getMaxListeners=function(){return tL(this)},tN.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var a,s=Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var o=r[e];if(void 0===o)return!1;if("function"==typeof o)tI(o,this,t);else for(var c=o.length,l=tP(o,c),n=0;n<c;++n)tI(l[n],this,t);return!0},tN.prototype.addListener=function(e,t){return tO(this,e,t,!1)},tN.prototype.on=tN.prototype.addListener,tN.prototype.prependListener=function(e,t){return tO(this,e,t,!0)},tN.prototype.once=function(e,t){return tA(t),this.on(e,tF(this,e,t)),this},tN.prototype.prependOnceListener=function(e,t){return tA(t),this.prependListener(e,tF(this,e,t)),this},tN.prototype.removeListener=function(e,t){var n,i,r,a,s;if(tA(t),void 0===(i=this._events)||void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){s=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},tN.prototype.off=tN.prototype.removeListener,tN.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0==arguments.length){var r,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},tN.prototype.listeners=function(e){return tD(this,e,!0)},tN.prototype.rawListeners=function(e){return tD(this,e,!1)},tN.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):tR.call(e,t)},tN.prototype.listenerCount=tR,tN.prototype.eventNames=function(){return this._eventsCount>0?K(this._events):[]};var t_=tS.exports;(b=V||(V={})).Connected="connected",b.Reconnecting="reconnecting",b.SignalReconnecting="signalReconnecting",b.Reconnected="reconnected",b.Disconnected="disconnected",b.ConnectionStateChanged="connectionStateChanged",b.MediaDevicesChanged="mediaDevicesChanged",b.ParticipantConnected="participantConnected",b.ParticipantDisconnected="participantDisconnected",b.TrackPublished="trackPublished",b.TrackSubscribed="trackSubscribed",b.TrackSubscriptionFailed="trackSubscriptionFailed",b.TrackUnpublished="trackUnpublished",b.TrackUnsubscribed="trackUnsubscribed",b.TrackMuted="trackMuted",b.TrackUnmuted="trackUnmuted",b.LocalTrackPublished="localTrackPublished",b.LocalTrackUnpublished="localTrackUnpublished",b.LocalAudioSilenceDetected="localAudioSilenceDetected",b.ActiveSpeakersChanged="activeSpeakersChanged",b.ParticipantMetadataChanged="participantMetadataChanged",b.ParticipantNameChanged="participantNameChanged",b.ParticipantAttributesChanged="participantAttributesChanged",b.RoomMetadataChanged="roomMetadataChanged",b.DataReceived="dataReceived",b.SipDTMFReceived="sipDTMFReceived",b.TranscriptionReceived="transcriptionReceived",b.ConnectionQualityChanged="connectionQualityChanged",b.TrackStreamStateChanged="trackStreamStateChanged",b.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",b.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",b.AudioPlaybackStatusChanged="audioPlaybackChanged",b.VideoPlaybackStatusChanged="videoPlaybackChanged",b.MediaDevicesError="mediaDevicesError",b.ParticipantPermissionsChanged="participantPermissionsChanged",b.SignalConnected="signalConnected",b.RecordingStatusChanged="recordingStatusChanged",b.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",b.EncryptionError="encryptionError",b.DCBufferStatusChanged="dcBufferStatusChanged",b.ActiveDeviceChanged="activeDeviceChanged",b.ChatMessage="chatMessage",b.LocalTrackSubscribed="localTrackSubscribed",(v=j||(j={})).TrackPublished="trackPublished",v.TrackSubscribed="trackSubscribed",v.TrackSubscriptionFailed="trackSubscriptionFailed",v.TrackUnpublished="trackUnpublished",v.TrackUnsubscribed="trackUnsubscribed",v.TrackMuted="trackMuted",v.TrackUnmuted="trackUnmuted",v.LocalTrackPublished="localTrackPublished",v.LocalTrackUnpublished="localTrackUnpublished",v.ParticipantMetadataChanged="participantMetadataChanged",v.ParticipantNameChanged="participantNameChanged",v.DataReceived="dataReceived",v.SipDTMFReceived="sipDTMFReceived",v.TranscriptionReceived="transcriptionReceived",v.IsSpeakingChanged="isSpeakingChanged",v.ConnectionQualityChanged="connectionQualityChanged",v.TrackStreamStateChanged="trackStreamStateChanged",v.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",v.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",v.MediaDevicesError="mediaDevicesError",v.AudioStreamAcquired="audioStreamAcquired",v.ParticipantPermissionsChanged="participantPermissionsChanged",v.PCTrackAdded="pcTrackAdded",v.AttributesChanged="attributesChanged",v.LocalTrackSubscribed="localTrackSubscribed",v.ChatMessage="chatMessage",(k=G||(G={})).TransportsCreated="transportsCreated",k.Connected="connected",k.Disconnected="disconnected",k.Resuming="resuming",k.Resumed="resumed",k.Restarting="restarting",k.Restarted="restarted",k.SignalResumed="signalResumed",k.SignalRestarted="signalRestarted",k.Closing="closing",k.MediaTrackAdded="mediaTrackAdded",k.ActiveSpeakersUpdate="activeSpeakersUpdate",k.DataPacketReceived="dataPacketReceived",k.RTPVideoMapUpdate="rtpVideoMapUpdate",k.DCBufferStatusChanged="dcBufferStatusChanged",k.ParticipantUpdate="participantUpdate",k.RoomUpdate="roomUpdate",k.SpeakersChanged="speakersChanged",k.StreamStateChanged="streamStateChanged",k.ConnectionQualityUpdate="connectionQualityUpdate",k.SubscriptionError="subscriptionError",k.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",k.RemoteMute="remoteMute",k.SubscribedQualityUpdate="subscribedQualityUpdate",k.LocalTrackUnpublished="localTrackUnpublished",k.LocalTrackSubscribed="localTrackSubscribed",k.Offline="offline",k.SignalRequestResponse="signalRequestResponse",(w=J||(J={})).Message="message",w.Muted="muted",w.Unmuted="unmuted",w.Restarted="restarted",w.Ended="ended",w.Subscribed="subscribed",w.Unsubscribed="unsubscribed",w.UpdateSettings="updateSettings",w.UpdateSubscription="updateSubscription",w.AudioPlaybackStarted="audioPlaybackStarted",w.AudioPlaybackFailed="audioPlaybackFailed",w.AudioSilenceDetected="audioSilenceDetected",w.VisibilityChanged="visibilityChanged",w.VideoDimensionsChanged="videoDimensionsChanged",w.VideoPlaybackStarted="videoPlaybackStarted",w.VideoPlaybackFailed="videoPlaybackFailed",w.ElementAttached="elementAttached",w.ElementDetached="elementDetached",w.UpstreamPaused="upstreamPaused",w.UpstreamResumed="upstreamResumed",w.SubscriptionPermissionChanged="subscriptionPermissionChanged",w.SubscriptionStatusChanged="subscriptionStatusChanged",w.SubscriptionFailed="subscriptionFailed",w.TrackProcessorUpdate="trackProcessorUpdate",w.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",w.TranscriptionReceived="transcriptionReceived",w.TimeSyncUpdate="timeSyncUpdate";let tB=[];(S=q||(q={}))[S.LOW=0]="LOW",S[S.MEDIUM=1]="MEDIUM",S[S.HIGH=2]="HIGH";class tM extends t_.EventEmitter{constructor(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.attachedElements=[],this.isMuted=!1,this.streamState=tM.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=ea,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),"hidden"===document.visibilityState?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),5e3):this.handleAppVisibilityChanged()},this.log=es(null!==(n=i.loggerName)&&void 0!==n?n:P.Track),this.loggerContextCb=i.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=tM.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),function e(t){return t instanceof tM?{trackID:t.sid,source:t.source,muted:t.isMuted,enabled:t.mediaStreamTrack.enabled,kind:t.kind,streamID:t.mediaStreamID,streamTrackID:t.mediaStreamTrack.id}:{trackID:t.trackSid,enabled:t.isEnabled,muted:t.isMuted,trackInfo:Object.assign({mimeType:t.mimeType,name:t.trackName,encrypted:t.isEncrypted,kind:t.kind,source:t.source},t.track?e(t.track):{})}}(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){var t,n,i;let r,a,s="audio";this.kind===tM.Kind.Video&&(s="video"),0===this.attachedElements.length&&this.kind===tM.Kind.Video&&this.addAppVisibilityListener(),e||("audio"===s&&(tB.forEach(t=>{null!==t.parentElement||e||(e=t)}),e&&tB.splice(tB.indexOf(e),1)),e||(e=document.createElement(s))),this.attachedElements.includes(e)||this.attachedElements.push(e),t=this.mediaStreamTrack,(n=e).srcObject instanceof MediaStream?r=n.srcObject:r=new MediaStream,(a="audio"===t.kind?r.getAudioTracks():r.getVideoTracks()).includes(t)||(a.forEach(e=>{r.removeTrack(e)}),r.addTrack(t)),tV()&&n instanceof HTMLVideoElement||(n.autoplay=!0),n.muted=0===r.getAudioTracks().length,n instanceof HTMLVideoElement&&(n.playsInline=!0),n.srcObject!==r&&(n.srcObject=r,(tV()||(null===(i=tg())||void 0===i?void 0:i.name)==="Firefox")&&n instanceof HTMLVideoElement&&setTimeout(()=>{n.srcObject=r,n.play().catch(()=>{})},0));let o=e.srcObject.getTracks(),c=o.some(e=>"audio"===e.kind);return e.play().then(()=>{this.emit(c?J.AudioPlaybackStarted:J.VideoPlaybackStarted)}).catch(t=>{"NotAllowedError"===t.name?this.emit(c?J.AudioPlaybackFailed:J.VideoPlaybackFailed,t):"AbortError"===t.name?ea.debug("".concat(c?"audio":"video"," playback aborted, likely due to new play request")):ea.warn("could not playback ".concat(c?"audio":"video"),t),c&&e&&o.some(e=>"video"===e.kind)&&"NotAllowedError"===t.name&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(J.ElementAttached,e),e}detach(e){try{if(e){tK(this.mediaStreamTrack,e);let t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e),this.emit(J.ElementDetached,e)),e}let t=[];return this.attachedElements.forEach(e=>{tK(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e),this.emit(J.ElementDetached,e)}),this.attachedElements=[],t}finally{0===this.attachedElements.length&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=es(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),tB.forEach(e=>{e.parentElement||(t=!1)}),t&&tB.push(e)}}handleAppVisibilityChanged(){return et(this,void 0,void 0,function*(){this.isInBackground="hidden"===document.visibilityState,this.isInBackground||this.kind!==tM.Kind.Video||setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){tj()?(this.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){tj()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function tK(e,t){if(t.srcObject instanceof MediaStream){let n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}function tV(){var e;return(null===(e=tg())||void 0===e?void 0:e.name)==="Safari"}function tj(){return"undefined"!=typeof document}(I=s=(T=tM||(tM={})).Kind||(T.Kind={})).Audio="audio",I.Video="video",I.Unknown="unknown",(E=o=T.Source||(T.Source={})).Camera="camera",E.Microphone="microphone",E.ScreenShare="screen_share",E.ScreenShareAudio="screen_share_audio",E.Unknown="unknown",(N=c=T.StreamState||(T.StreamState={})).Active="active",N.Paused="paused",N.Unknown="unknown",T.kindToProto=function(e){switch(e){case s.Audio:return tf.AUDIO;case s.Video:return tf.VIDEO;default:return tf.DATA}},T.kindFromProto=function(e){switch(e){case tf.AUDIO:return s.Audio;case tf.VIDEO:return s.Video;default:return s.Unknown}},T.sourceToProto=function(e){switch(e){case o.Camera:return tp.CAMERA;case o.Microphone:return tp.MICROPHONE;case o.ScreenShare:return tp.SCREEN_SHARE;case o.ScreenShareAudio:return tp.SCREEN_SHARE_AUDIO;default:return tp.UNKNOWN}},T.sourceFromProto=function(e){switch(e){case tp.CAMERA:return o.Camera;case tp.MICROPHONE:return o.Microphone;case tp.SCREEN_SHARE:return o.ScreenShare;case tp.SCREEN_SHARE_AUDIO:return o.ScreenShareAudio;default:return o.Unknown}},T.streamStateFromProto=function(e){switch(e){case ty.ACTIVE:return c.Active;case ty.PAUSED:return c.Paused;default:return c.Unknown}};class tG{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){let e;this._locks+=1;let t=new Promise(t=>e=()=>{this._locks-=1,t()}),n=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),n}}(C=X||(X={}))[C.WAITING=0]="WAITING",C[C.RUNNING=1]="RUNNING",C[C.COMPLETED=2]="COMPLETED";class tJ{constructor(){this.pendingTasks=new Map,this.taskMutex=new tG,this.nextTaskIndex=0}run(e){return et(this,void 0,void 0,function*(){let t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:X.WAITING};this.pendingTasks.set(t.id,t);let n=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=X.RUNNING,yield e()}finally{t.status=X.COMPLETED,this.pendingTasks.delete(t.id),n()}})}flush(){return et(this,void 0,void 0,function*(){return this.run(()=>et(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}let tq="AES-GCM",tX={key:10,delta:3,audio:1,empty:0};class tW extends Error{constructor(e,t){super(t||"an error has occured"),this.code=e}}(A=W||(W={})).PermissionDenied="PermissionDenied",A.NotFound="NotFound",A.DeviceInUse="DeviceInUse",A.Other="Other",(L=W||(W={})).getFailure=function(e){if(e&&"name"in e)return"NotFoundError"===e.name||"DevicesNotFoundError"===e.name?L.NotFound:"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?L.PermissionDenied:"NotReadableError"===e.name||"TrackStartError"===e.name?L.DeviceInUse:L.Other},(O=H||(H={}))[O.InvalidKey=0]="InvalidKey",O[O.MissingKey=1]="MissingKey",O[O.InternalError=2]="InternalError";class tH extends tW{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H.InternalError,n=arguments.length>2?arguments[2]:void 0;super(40,e),this.reason=t,this.participantIdentity=n}}function tY(e,t){let n=new TextEncoder().encode(t);switch(e){case"HKDF":return{name:"HKDF",salt:n,hash:"SHA-256",info:new ArrayBuffer(128)};case"PBKDF2":return{name:"PBKDF2",salt:n,hash:"SHA-256",iterations:1e5};default:throw Error("algorithm ".concat(e," is currently unsupported"))}}function tz(e,t){return et(this,void 0,void 0,function*(){let n=tY(e.algorithm.name,t),i=yield crypto.subtle.deriveKey(n,e,{name:tq,length:128},!1,["encrypt","decrypt"]);return{material:e,encryptionKey:i}})}(U=Y||(Y={})).SetKey="setKey",U.RatchetRequest="ratchetRequest",U.KeyRatcheted="keyRatcheted",(z||(z={})).KeyRatcheted="keyRatcheted",(F=Q||(Q={})).ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",F.EncryptionError="encryptionError",($||($={})).Error="cryptorError";class tQ{constructor(){this.consecutiveSifCount=0,this.lastSifReceivedAt=0,this.userFramesSinceSif=0}recordSif(){var e;this.consecutiveSifCount+=1,null!==(e=this.sifSequenceStartedAt)&&void 0!==e||(this.sifSequenceStartedAt=Date.now()),this.lastSifReceivedAt=Date.now()}recordUserFrame(){void 0!==this.sifSequenceStartedAt&&(this.userFramesSinceSif+=1,(this.userFramesSinceSif>this.consecutiveSifCount||Date.now()-this.lastSifReceivedAt>2e3)&&this.reset())}isSifAllowed(){return this.consecutiveSifCount<100&&(void 0===this.sifSequenceStartedAt||Date.now()-this.sifSequenceStartedAt<2e3)}reset(){this.userFramesSinceSif=0,this.consecutiveSifCount=0,this.sifSequenceStartedAt=void 0}}let t$=new Map;class tZ extends t_.EventEmitter{encodeFunction(e,t){throw Error("not implemented for subclass")}decodeFunction(e,t){throw Error("not implemented for subclass")}}class t0 extends tZ{constructor(e){var t;super(),this.sendCounts=new Map,this.keys=e.keys,this.participantIdentity=e.participantIdentity,this.rtpMap=new Map,this.keyProviderOptions=e.keyProviderOptions,this.sifTrailer=null!==(t=e.sifTrailer)&&void 0!==t?t:Uint8Array.from([]),this.sifGuard=new tQ}get logContext(){return{participant:this.participantIdentity,mediaTrackId:this.trackId,fallbackCodec:this.videoCodec}}setParticipant(e,t){eo.debug("setting new participant on cryptor",Object.assign(Object.assign({},this.logContext),{participant:e})),this.participantIdentity&&eo.error("cryptor has already a participant set, participant should have been unset before",Object.assign({},this.logContext)),this.participantIdentity=e,this.keys=t,this.sifGuard.reset()}unsetParticipant(){eo.debug("unsetting participant",this.logContext),this.participantIdentity=void 0}isEnabled(){return this.participantIdentity?t$.get(this.participantIdentity):void 0}getParticipantIdentity(){return this.participantIdentity}getTrackId(){return this.trackId}setVideoCodec(e){this.videoCodec=e}setRtpMap(e){this.rtpMap=e}setupTransform(e,t,n,i,r){r&&(eo.info("setting codec on cryptor to",{codec:r}),this.videoCodec=r),eo.debug("Setting up frame cryptor transform",Object.assign({operation:e,passedTrackId:i,codec:r},this.logContext));let a=new TransformStream({transform:("encode"===e?this.encodeFunction:this.decodeFunction).bind(this)});t.pipeThrough(a).pipeTo(n).catch(e=>{eo.warn(e),this.emit($.Error,e instanceof tH?e:new tH(e.message,void 0,this.participantIdentity))}),this.trackId=i}setSifTrailer(e){eo.debug("setting SIF trailer",Object.assign(Object.assign({},this.logContext),{trailer:e})),this.sifTrailer=e}encodeFunction(e,t){return et(this,void 0,void 0,function*(){var n;if(!this.isEnabled()||0===e.data.byteLength)return t.enqueue(e);let i=this.keys.getKeySet();if(!i){this.emit($.Error,new tH("key set not found for ".concat(this.participantIdentity," at index ").concat(this.keys.getCurrentKeyIndex()),H.MissingKey,this.participantIdentity));return}let{encryptionKey:r}=i,a=this.keys.getCurrentKeyIndex();if(r){let i=this.makeIV(null!==(n=e.getMetadata().synchronizationSource)&&void 0!==n?n:-1,e.timestamp),o=this.getUnencryptedBytes(e),c=new Uint8Array(e.data,0,o.unencryptedBytes),l=new Uint8Array(2);l[0]=12,l[1]=a;try{let n=yield crypto.subtle.encrypt({name:tq,iv:i,additionalData:new Uint8Array(e.data,0,c.byteLength)},r,new Uint8Array(e.data,o.unencryptedBytes)),a=new Uint8Array(n.byteLength+i.byteLength+l.byteLength);a.set(new Uint8Array(n)),a.set(new Uint8Array(i),n.byteLength),a.set(l,n.byteLength+i.byteLength),o.isH264&&(a=function(e){let t=[];for(var n=0,i=0;i<e.length;++i){var r=e[i];r<=3&&n>=2&&(t.push(3),n=0),t.push(r),0==r?++n:n=0}return new Uint8Array(t)}(a));var s=new Uint8Array(c.byteLength+a.byteLength);return s.set(c),s.set(a,c.byteLength),e.data=s.buffer,t.enqueue(e)}catch(e){eo.error(e)}}else eo.debug("failed to encrypt, emitting error",this.logContext),this.emit($.Error,new tH("encryption key missing for encoding",H.MissingKey,this.participantIdentity))})}decodeFunction(e,t){return et(this,void 0,void 0,function*(){if(!this.isEnabled()||0===e.data.byteLength)return eo.debug("skipping empty frame",this.logContext),this.sifGuard.recordUserFrame(),t.enqueue(e);if(function(e,t){if(0===t.byteLength)return!1;let n=new Uint8Array(e.slice(e.byteLength-t.byteLength));return t.every((e,t)=>e===n[t])}(e.data,this.sifTrailer))return(eo.debug("enqueue SIF",this.logContext),this.sifGuard.recordSif(),this.sifGuard.isSifAllowed())?(e.data=e.data.slice(0,e.data.byteLength-this.sifTrailer.byteLength),t.enqueue(e)):void eo.warn("SIF limit reached, dropping frame");this.sifGuard.recordUserFrame();let n=new Uint8Array(e.data)[e.data.byteLength-1];if(this.keys.getKeySet(n)&&this.keys.hasValidKey)try{let i=yield this.decryptFrame(e,n);if(this.keys.decryptionSuccess(),i)return t.enqueue(i)}catch(e){e instanceof tH&&e.reason===H.InvalidKey?this.keys.hasValidKey&&(this.emit($.Error,e),this.keys.decryptionFailure()):eo.warn("decoding frame failed",{error:e})}else!this.keys.getKeySet(n)&&this.keys.hasValidKey&&(eo.warn("skipping decryption due to missing key at index ".concat(n)),this.emit($.Error,new tH("missing key at index ".concat(n," for participant ").concat(this.participantIdentity),H.MissingKey,this.participantIdentity)),this.keys.decryptionFailure())})}decryptFrame(e,t){return et(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{ratchetCount:0};return function*(){var a;let s=n.keys.getKeySet(t);if(!r.encryptionKey&&!s)throw TypeError("no encryption key found for decryption of ".concat(n.participantIdentity));let o=n.getUnencryptedBytes(e);try{let t=new Uint8Array(e.data,0,o.unencryptedBytes);var c=new Uint8Array(e.data,t.length,e.data.byteLength-t.length);if(o.isH264&&function(e){for(var t=0;t<e.length-3;t++)if(0==e[t]&&0==e[t+1]&&3==e[t+2])return!0;return!1}(c)){c=function(e){let t=[];for(var n=e.length,i=0;i<e.length;)!(n-i>=3)||e[i]||e[i+1]||3!=e[i+2]?t.push(e[i++]):(t.push(e[i++]),t.push(e[i++]),i++);return new Uint8Array(t)}(c);let n=new Uint8Array(t.byteLength+c.byteLength);n.set(t),n.set(c,t.byteLength),e.data=n.buffer}let n=new Uint8Array(e.data,e.data.byteLength-2,2),i=n[0],l=new Uint8Array(e.data,e.data.byteLength-i-n.byteLength,i),u=t.byteLength,d=e.data.byteLength-(t.byteLength+i+n.byteLength),h=yield crypto.subtle.decrypt({name:tq,iv:l,additionalData:new Uint8Array(e.data,0,t.byteLength)},null!==(a=r.encryptionKey)&&void 0!==a?a:s.encryptionKey,new Uint8Array(e.data,u,d)),f=new ArrayBuffer(t.byteLength+h.byteLength),p=new Uint8Array(f);return p.set(new Uint8Array(e.data,0,t.byteLength)),p.set(new Uint8Array(h),t.byteLength),e.data=f,e}catch(a){if(n.keyProviderOptions.ratchetWindowSize>0){if(r.ratchetCount<n.keyProviderOptions.ratchetWindowSize){let a;if(eo.debug("ratcheting key attempt ".concat(r.ratchetCount," of ").concat(n.keyProviderOptions.ratchetWindowSize,", for kind ").concat(e instanceof RTCEncodedAudioFrame?"audio":"video")),(null!=i?i:s)===n.keys.getKeySet(t)){let e=yield n.keys.ratchetKey(t,!1);a=yield tz(e,n.keyProviderOptions.ratchetSalt)}let o=yield n.decryptFrame(e,t,i||s,{ratchetCount:r.ratchetCount+1,encryptionKey:null==a?void 0:a.encryptionKey});return o&&a&&(null!=i?i:s)===n.keys.getKeySet(t)&&(n.keys.setKeySet(a,t,!0),n.keys.setCurrentKeyIndex(t)),o}throw eo.warn("maximum ratchet attempts exceeded"),new tH("valid key missing for participant ".concat(n.participantIdentity),H.InvalidKey,n.participantIdentity)}throw new tH("Decryption failed: ".concat(a.message),H.InvalidKey,n.participantIdentity)}}()})}makeIV(e,t){var n;let i=new ArrayBuffer(12),r=new DataView(i);this.sendCounts.has(e)||this.sendCounts.set(e,Math.floor(65535*Math.random()));let a=null!==(n=this.sendCounts.get(e))&&void 0!==n?n:0;return r.setUint32(0,e),r.setUint32(4,t),r.setUint32(8,t-a%65535),this.sendCounts.set(e,a+1),i}getUnencryptedBytes(e){var t,n={unencryptedBytes:0,isH264:!1};if(!("type"in e))return n.unencryptedBytes=tX.audio,n;{let i=null!==(t=this.getVideoCodec(e))&&void 0!==t?t:this.videoCodec;if(i!==this.detectedCodec&&(eo.debug("detected different codec",Object.assign({detectedCodec:i,oldCodec:this.detectedCodec},this.logContext)),this.detectedCodec=i),"av1"===i)throw Error("".concat(i," is not yet supported for end to end encryption"));if("vp8"===i)n.unencryptedBytes=tX[e.type];else if("vp9"===i)return n.unencryptedBytes=0,n;let r=new Uint8Array(e.data);try{let e=function(e){let t=[],n=0,i=0,r=e.length-2;for(;i<r;){for(;i<r&&!(0===e[i]&&0===e[i+1]&&1===e[i+2]);)i++;i>=r&&(i=e.length);let a=i;for(;a>n&&0===e[a-1];)a--;if(0===n){if(a!==n)throw TypeError("byte stream contains leading data")}else t.push(n);n=i+=3}return t}(r);if(n.isH264="h264"===i||e.some(e=>[Z.SLICE_IDR,Z.SLICE_NON_IDR].includes(r[e]&t2)),n.isH264){for(let t of e)switch(r[t]&t2){case Z.SLICE_IDR:case Z.SLICE_NON_IDR:return n.unencryptedBytes=t+2,n}throw TypeError("Could not find NALU")}}catch(e){}return n.unencryptedBytes=tX[e.type],n}}getVideoCodec(e){if(0===this.rtpMap.size)return;let t=e.getMetadata().payloadType;return t?this.rtpMap.get(t):void 0}}let t2=31;(D=Z||(Z={}))[D.SLICE_NON_IDR=1]="SLICE_NON_IDR",D[D.SLICE_PARTITION_A=2]="SLICE_PARTITION_A",D[D.SLICE_PARTITION_B=3]="SLICE_PARTITION_B",D[D.SLICE_PARTITION_C=4]="SLICE_PARTITION_C",D[D.SLICE_IDR=5]="SLICE_IDR",D[D.SEI=6]="SEI",D[D.SPS=7]="SPS",D[D.PPS=8]="PPS",D[D.AUD=9]="AUD",D[D.END_SEQ=10]="END_SEQ",D[D.END_STREAM=11]="END_STREAM",D[D.FILLER_DATA=12]="FILLER_DATA",D[D.SPS_EXT=13]="SPS_EXT",D[D.PREFIX_NALU=14]="PREFIX_NALU",D[D.SUBSET_SPS=15]="SUBSET_SPS",D[D.DPS=16]="DPS",D[D.SLICE_AUX=19]="SLICE_AUX",D[D.SLICE_EXT=20]="SLICE_EXT",D[D.SLICE_LAYER_EXT=21]="SLICE_LAYER_EXT";class t1 extends t_.EventEmitter{get hasValidKey(){return this._hasValidKey}constructor(e,t){if(super(),this.decryptionFailureCount=0,this._hasValidKey=!0,this.currentKeyIndex=0,t.keyringSize<1||t.keyringSize>255)throw TypeError("Keyring size needs to be between 1 and 256");this.cryptoKeyRing=Array(t.keyringSize).fill(void 0),this.keyProviderOptions=t,this.ratchetPromiseMap=new Map,this.participantIdentity=e,this.resetKeyStatus()}decryptionFailure(){!(this.keyProviderOptions.failureTolerance<0)&&(this.decryptionFailureCount+=1,this.decryptionFailureCount>this.keyProviderOptions.failureTolerance&&(eo.warn("key for ".concat(this.participantIdentity," is being marked as invalid")),this._hasValidKey=!1))}decryptionSuccess(){this.resetKeyStatus()}resetKeyStatus(){this.decryptionFailureCount=0,this._hasValidKey=!0}ratchetKey(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=null!=e?e:this.getCurrentKeyIndex(),i=this.ratchetPromiseMap.get(n);if(void 0!==i)return i;let r=new Promise((e,i)=>et(this,void 0,void 0,function*(){try{let i=this.getKeySet(n);if(!i)throw TypeError("Cannot ratchet key without a valid keyset of participant ".concat(this.participantIdentity));let r=i.material,a=yield function(e){return et(this,arguments,void 0,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{name:tq},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"encrypt";return function*(){return crypto.subtle.importKey("raw",e,t,!1,"derive"===n?["deriveBits","deriveKey"]:["encrypt","decrypt"])}()})}((yield function(e,t){return et(this,void 0,void 0,function*(){let n=tY(e.algorithm.name,t);return crypto.subtle.deriveBits(n,e,256)})}(r,this.keyProviderOptions.ratchetSalt)),r.algorithm.name,"derive");t&&(this.setKeyFromMaterial(a,n,!0),this.emit(z.KeyRatcheted,a,this.participantIdentity,n)),e(a)}catch(e){i(e)}finally{this.ratchetPromiseMap.delete(n)}}));return this.ratchetPromiseMap.set(n,r),r}setKey(e){return et(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function*(){yield t.setKeyFromMaterial(e,n),t.resetKeyStatus()}()})}setKeyFromMaterial(e,t){return et(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){let r=yield tz(e,n.keyProviderOptions.ratchetSalt),a=t>=0?t%n.cryptoKeyRing.length:n.currentKeyIndex;eo.debug("setting new key with index ".concat(t),{usage:e.usages,algorithm:e.algorithm,ratchetSalt:n.keyProviderOptions.ratchetSalt}),n.setKeySet(r,a,i),a>=0&&(n.currentKeyIndex=a)}()})}setKeySet(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.cryptoKeyRing[t%this.cryptoKeyRing.length]=e,n&&this.emit(z.KeyRatcheted,e.material,this.participantIdentity,t)}setCurrentKeyIndex(e){return et(this,void 0,void 0,function*(){this.currentKeyIndex=e%this.cryptoKeyRing.length,this.resetKeyStatus()})}getCurrentKeyIndex(){return this.currentKeyIndex}getKeySet(e){return this.cryptoKeyRing[null!=e?e:this.currentKeyIndex]}}let t3=[],t4=new Map,t6=new tJ,t8=!1,t5={sharedKey:!1,ratchetSalt:"LKFrameEncryptionKey",ratchetWindowSize:8,failureTolerance:10,keyringSize:16},t7=new Map;function t9(e,t){let n=t3.filter(e=>e.getTrackId()===t);if(n.length>1){let i=n.map(e=>({participant:e.getParticipantIdentity()})).join(",");eo.error("Found multiple cryptors for the same trackID ".concat(t,". target participant: ").concat(e," "),{participants:i})}let i=n[0];if(i)e!==i.getParticipantIdentity()&&i.setParticipant(e,ne(e));else{if(eo.info("creating new cryptor for",{participantIdentity:e}),!t5)throw Error("Missing keyProvider options");(i=new t0({participantIdentity:e,keys:ne(e),keyProviderOptions:t5,sifTrailer:a})).setRtpMap(t7),function(e){e.on($.Error,e=>{postMessage({kind:"error",data:{error:Error("".concat(H[e.reason],": ").concat(e.message))}})})}(i),t3.push(i)}return i}function ne(e){if(t8)return nt();let t=t4.get(e);return t||((t=new t1(e,t5)).on(z.KeyRatcheted,nn),t4.set(e,t)),t}function nt(){return r||(eo.debug("creating new shared key handler"),r=new t1("shared-key",t5)),r}function nn(e,t,n){postMessage({kind:"ratchetKey",data:{participantIdentity:t,keyIndex:n,material:e}})}eo.setDefaultLevel("info"),onmessage=e=>{t6.run(()=>et(void 0,void 0,void 0,function*(){var t,n,i;let{kind:r,data:s}=e.data;switch(r){case"init":eo.setLevel(s.loglevel),eo.info("worker initialized"),t5=s.keyProviderOptions,t8=!!s.keyProviderOptions.sharedKey,postMessage({kind:"initAck",data:{enabled:!1}});break;case"enable":t=s.enabled,n=s.participantIdentity,eo.debug("setting encryption enabled for all tracks of ".concat(n),{enable:t}),t$.set(n,t),eo.info("updated e2ee enabled status for ".concat(s.participantIdentity," to ").concat(s.enabled)),postMessage(e.data);break;case"decode":case"encode":t9(s.participantIdentity,s.trackId).setupTransform(r,s.readableStream,s.writableStream,s.trackId,s.codec);break;case"setKey":t8?yield function(e,t){return et(this,void 0,void 0,function*(){eo.info("set shared key",{index:t}),yield nt().setKey(e,t)})}(s.key,s.keyIndex):s.participantIdentity?(eo.info("set participant sender key ".concat(s.participantIdentity," index ").concat(s.keyIndex)),yield ne(s.participantIdentity).setKey(s.key,s.keyIndex)):eo.error("no participant Id was provided and shared key usage is disabled");break;case"removeTransform":(function(e,t){let n=t3.filter(n=>n.getParticipantIdentity()===t&&n.getTrackId()===e);n.length>1&&eo.error("Found multiple cryptors for the same participant and trackID combination",{trackId:e,participantIdentity:t});let i=n[0];i?i.unsetParticipant():eo.warn("Could not unset participant on cryptor",{trackId:e,participantIdentity:t})})(s.trackId,s.participantIdentity);break;case"updateCodec":t9(s.participantIdentity,s.trackId).setVideoCodec(s.codec);break;case"setRTPMap":t7=s.map,t3.forEach(e=>{e.getParticipantIdentity()===s.participantIdentity&&e.setRtpMap(s.map)});break;case"ratchetRequest":(function(e){et(this,void 0,void 0,function*(){if(t8){let t=nt();yield t.ratchetKey(e.keyIndex),t.resetKeyStatus()}else if(e.participantIdentity){let t=ne(e.participantIdentity);yield t.ratchetKey(e.keyIndex),t.resetKeyStatus()}else eo.error("no participant Id was provided for ratchet request and shared key usage is disabled")})})(s);break;case"setSifTrailer":a=i=s.trailer,t3.forEach(e=>{e.setSifTrailer(i)})}}))},self.RTCTransformEvent&&(eo.debug("setup transform event"),self.onrtctransform=e=>{let t=e.transformer;eo.debug("transformer",t),t.handled=!0;let{kind:n,participantIdentity:i,trackId:r,codec:a}=t.options,s=t9(i,r);eo.debug("transform",{codec:a}),s.setupTransform(n,t.readable,t.writable,r,a)})}}]);
//# sourceMappingURL=79255d22.5786c080593f330a.js.map