(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[411],{125:function(e,o,n){Promise.resolve().then(n.bind(n,8075))},8075:function(e,o,n){"use strict";n.r(o),n.d(o,{default:function(){return S},dynamic:function(){return C}});var t,i=n(7437),r=n(2265),s=n(9376),a=n(9413),c=n(7598),d=n(2854);function u(){let e=(0,d.Y)(),[o,n]=r.useState(!1);return r.useEffect(()=>{e!==o&&(n(e),e&&window.alert("This meeting is being recorded"))},[e]),(0,i.jsx)("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",boxShadow:e?"red 0px 0px 0px 3px inset":"none",pointerEvents:"none"}})}var l=n(1292),h=n(6602),p=n(4187),v=n(3557),m=n(6958),f=n(257);let g=null!==(t=f.env.NEXT_PUBLIC_CONN_DETAILS_ENDPOINT)&&void 0!==t?t:"/api/connection-details",E="true"==f.env.NEXT_PUBLIC_SHOW_SETTINGS_MENU;function b(e){let[o,n]=(0,r.useState)(void 0),[t,s]=(0,r.useState)(void 0),a=(0,r.useMemo)(()=>({username:"",videoEnabled:!0,audioEnabled:!0}),[]),c=(0,r.useCallback)(async o=>{n(o);try{let n=new URL(g,window.location.origin);n.searchParams.append("roomName",e.roomName),n.searchParams.append("participantName",o.username),e.region&&n.searchParams.append("region",e.region);let t=await fetch(n.toString()),i=await t.json();s(i)}catch(e){console.error("Error fetching connection details:",e)}},[e.roomName,e.region]),d=(0,r.useCallback)(e=>console.error(e),[]);return(0,i.jsx)("main",{"data-lk-theme":"default",style:{height:"100%"},children:void 0===t||void 0===o?(0,i.jsx)("div",{style:{display:"grid",placeItems:"center",height:"100%"},children:(0,i.jsx)(h.tt,{defaults:a,onSubmit:c,onError:d})}):(0,i.jsx)(x,{connectionDetails:t,userChoices:o,options:{codec:e.codec,hq:e.hq}})})}function x(e){let o=(0,a.FZ)(location.hash.substring(1)),t=o&&new Worker(n.tu(new URL(n.p+n.u(257),n.b))),d=!!(o&&t),f=new m.P6,[g,b]=(0,r.useState)(!1),x=(0,r.useMemo)(()=>{var o,n;let i=e.options.codec?e.options.codec:"vp9";return d&&("av1"===i||"vp9"===i)&&(i=void 0),{videoCaptureDefaults:{deviceId:null!==(o=e.userChoices.videoDeviceId)&&void 0!==o?o:void 0,resolution:e.options.hq?m.OM.h2160:m.OM.h720},publishDefaults:{dtx:!1,videoSimulcastLayers:e.options.hq?[m.OM.h1080,m.OM.h720]:[m.OM.h540,m.OM.h216],red:!d,videoCodec:i},audioCaptureDefaults:{deviceId:null!==(n=e.userChoices.audioDeviceId)&&void 0!==n?n:void 0},adaptiveStream:{pixelDensity:"screen"},dynacast:!0,e2ee:d?{keyProvider:f,worker:t}:void 0}},[e.userChoices,e.options.hq,e.options.codec]),w=(0,r.useMemo)(()=>new m.du(x),[x]);(0,r.useEffect)(()=>{d?f.setKey((0,a.FZ)(o)).then(()=>{w.setE2EEEnabled(!0).catch(e=>{if(e instanceof m.Fc)alert("Your browser does not support encrypted meetings. Please update it and try again."),console.error(e);else throw e})}).then(()=>b(!0)):b(!0)},[d,w,o,f]);let C=(0,r.useMemo)(()=>({autoSubscribe:!0}),[]),N=(0,s.useRouter)(),S=(0,r.useCallback)(()=>N.push("/"),[N]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(p.L,{connect:g,room:w,token:e.connectionDetails.participantToken,serverUrl:e.connectionDetails.serverUrl,connectOptions:C,video:e.userChoices.videoEnabled,audio:e.userChoices.audioEnabled,onDisconnected:S,onError:e=>console.error(e),children:[(0,i.jsx)(h.zc,{chatMessageFormatter:v.o,SettingsComponent:E?l.T:void 0}),(0,i.jsx)(c.a,{}),(0,i.jsx)(u,{})]})})}var w=n(3985);let C="force-dynamic";function N(){let e=(0,s.useSearchParams)(),o=e.get("roomName")||"defaultRoom",n=e.get("region")||void 0,t=e.get("codec"),r=t&&(0,w.t)(t)?t:"vp9",a="true"===e.get("hq");return(0,i.jsx)(b,{roomName:o,region:n,hq:a,codec:r})}function S(){return(0,i.jsx)(r.Suspense,{fallback:(0,i.jsx)("div",{children:"Loading..."}),children:(0,i.jsx)(N,{})})}}},function(e){e.O(0,[786,481,311,126,971,117,744],function(){return e(e.s=125)}),_N_E=e.O()}]);
//# sourceMappingURL=page-db74d4b3cf1ed7cd.js.map