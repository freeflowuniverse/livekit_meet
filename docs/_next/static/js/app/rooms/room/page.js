(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[411],{5378:function(e,o,n){Promise.resolve().then(n.bind(n,1081))},1081:function(e,o,n){"use strict";n.r(o),n.d(o,{default:function(){return S},dynamic:function(){return C}});var t=n(8376),i=n(7894),r=n(5538),s=n(6345),a=n(9546),c=n(9691);function d(){const e=(0,c.Y)(),[o,n]=i.useState(!1);return i.useEffect((()=>{e!==o&&(n(e),e&&window.alert("This meeting is being recorded"))}),[e]),(0,t.jsx)("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",boxShadow:e?"red 0px 0px 0px 3px inset":"none",pointerEvents:"none"}})}var u,l=n(2298),h=n(8926),p=n(1270),v=n(8842),m=n(3342),f=n(8596);const g=null!==(u=f.env.NEXT_PUBLIC_CONN_DETAILS_ENDPOINT)&&void 0!==u?u:"/api/connection-details",E="true"==f.env.NEXT_PUBLIC_SHOW_SETTINGS_MENU;function b(e){const[o,n]=(0,i.useState)(void 0),[r,s]=(0,i.useState)(void 0),a=(0,i.useMemo)((()=>({username:"",videoEnabled:!0,audioEnabled:!0})),[]),c=(0,i.useCallback)((async o=>{n(o);try{const n=new URL(g,window.location.origin);n.searchParams.append("roomName",e.roomName),n.searchParams.append("participantName",o.username),e.region&&n.searchParams.append("region",e.region);const t=await fetch(n.toString()),i=await t.json();s(i)}catch(t){console.error("Error fetching connection details:",t)}}),[e.roomName,e.region]),d=(0,i.useCallback)((e=>console.error(e)),[]);return(0,t.jsx)("main",{"data-lk-theme":"default",style:{height:"100%"},children:void 0===r||void 0===o?(0,t.jsx)("div",{style:{display:"grid",placeItems:"center",height:"100%"},children:(0,t.jsx)(h.tt,{defaults:a,onSubmit:c,onError:d})}):(0,t.jsx)(x,{connectionDetails:r,userChoices:o,options:{codec:e.codec,hq:e.hq}})})}function x(e){const o=(0,s.FZ)(location.hash.substring(1)),c=o&&new Worker(n.tu(new URL(n.p+n.u(892),n.b))),u=!(!o||!c),f=new m.P6,[g,b]=(0,i.useState)(!1),x=(0,i.useMemo)((()=>{let o=e.options.codec?e.options.codec:"vp9";var n,t;return!u||"av1"!==o&&"vp9"!==o||(o=void 0),{videoCaptureDefaults:{deviceId:null!==(n=e.userChoices.videoDeviceId)&&void 0!==n?n:void 0,resolution:e.options.hq?m.OM.h2160:m.OM.h720},publishDefaults:{dtx:!1,videoSimulcastLayers:e.options.hq?[m.OM.h1080,m.OM.h720]:[m.OM.h540,m.OM.h216],red:!u,videoCodec:o},audioCaptureDefaults:{deviceId:null!==(t=e.userChoices.audioDeviceId)&&void 0!==t?t:void 0},adaptiveStream:{pixelDensity:"screen"},dynacast:!0,e2ee:u?{keyProvider:f,worker:c}:void 0}}),[e.userChoices,e.options.hq,e.options.codec]),w=(0,i.useMemo)((()=>new m.du(x)),[x]);(0,i.useEffect)((()=>{u?f.setKey((0,s.FZ)(o)).then((()=>{w.setE2EEEnabled(!0).catch((e=>{if(!(e instanceof m.Fc))throw e;alert("Your browser does not support encrypted meetings. Please update it and try again."),console.error(e)}))})).then((()=>b(!0))):b(!0)}),[u,w,o,f]);const C=(0,i.useMemo)((()=>({autoSubscribe:!0})),[]),N=(0,r.useRouter)(),S=(0,i.useCallback)((()=>N.push("/")),[N]);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(p.L,{connect:g,room:w,token:e.connectionDetails.participantToken,serverUrl:e.connectionDetails.serverUrl,connectOptions:C,video:e.userChoices.videoEnabled,audio:e.userChoices.audioEnabled,onDisconnected:S,onError:e=>console.error(e),children:[(0,t.jsx)(h.zc,{chatMessageFormatter:v.o,SettingsComponent:E?l.T:void 0}),(0,t.jsx)(a.a,{}),(0,t.jsx)(d,{})]})})}var w=n(8518);const C="force-dynamic";function N(){const e=(0,r.useSearchParams)(),o=e.get("roomName")||"defaultRoom",n=e.get("region")||void 0,i=e.get("codec"),s=i&&(0,w.t)(i)?i:"vp9",a="true"===e.get("hq");return(0,t.jsx)(b,{roomName:o,region:n,hq:a,codec:s})}function S(){return(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)("div",{children:"Loading..."}),children:(0,t.jsx)(N,{})})}}},function(e){e.O(0,[556,109,793,902,922,996,744],(function(){return o=5378,e(e.s=o);var o}));var o=e.O();_N_E=o}]);
//# sourceMappingURL=page.js.map